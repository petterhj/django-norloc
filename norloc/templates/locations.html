{% extends "page.html" %}

{% load thumbnail %}
{% load paginator %}

{% block title %}Opptakssteder | {% endblock %}

<!-- Cover -->
{% block cover %}
 <!--div id="map" class="map"></div-->
 <!-- TODO: filters? -->
 <dl class="sub-nav" role="menu">
  <!-- Productions -->
  <dt><i class="fa fa-map-marker"></i></dt>
  <dd class="dropdown" role="menuitem">
   <a data-dropdown="drop1" aria-controls="drop1" data-options="is_hover:true; hover_timeout:5000" aria-expanded="false">Fylke <i class="fa fa-caret-down"></i></a>
   <ul id="drop1" class="f-dropdown" data-dropdown-content aria-hidden="true" aria-autoclose="true" tabindex="-1">
    <li><a href="#">Alle</a></li>
    <li class="sep"></li>
    <li><a href="#">Akershus</a></li>
    <li><a href="#">Oslo</a></li>
    <li><a href="#">Hedmark</a></li>
   </ul>
  </dd>
 </dl>
{% endblock %}

<!-- Content -->
{% block content %}
 {% if locations %}
  <!-- Locations -->
  <div class="row">
   {% for location in locations %}
    {% if location.scene_set.count != 0 %}
     <div class="medium-6 columns">
      <!-- Production -->
      <div class="location">
       <a href=""><h1>{{ location.address }}, {{ location.municipality }}</h1></a>
       <i class="type fa fa-map-marker"></i>
       {% with location.photos.all|first as first_photo %}
        <h5>{% if first_photo %}{{ first_photo.title }}{% else %}&nbsp;{% endif %}</h5>

        {% if first_photo %}
         {% thumbnail first_photo.photo "450" as photo %}
          <div class="thumb" style="background-image: url('{{ photo.url }}');"></div>
         {% endthumbnail %}
        {% else %}
         <div class="thumb"></div>
        {% endif %}
       {% endwith %}
       <div class="description">
        <p class="truncate">{{ location.description }}</p>
       </div>
       <!-- Scenes -->
       <div class="scenes">
        {% for scene in location.scene_set.all %}
         <!-- Scene -->
         <div class="scene">
          {% if scene.production.poster %}
           {% thumbnail scene.production.poster "21x30" crop="top" as poster %}
            <a href="{% url 'production' scene.production.slug %}"><img src="{{ poster.url }}" class="poster" title="{{ scene.production.title }} ({{ scene.production.release.year }})"></a>
           {% endthumbnail %}
          {% else %}
           {% if scene.production.backdrop %}
            {% thumbnail scene.production.backdrop "21x30" crop="center" as backdrop %}
             <a href="{% url 'production' scene.production.slug %}"><img src="{{ backdrop.url }}" class="poster" title="{{ scene.production.title }} ({{ scene.production.release.year }})"></a>
            {% endthumbnail %}
           {% endif %}
          {% endif %}
          {% for shot in scene.shot_set.all %}
           {% thumbnail shot.image "53x30" crop="center" as shot %}
            <img src="{{ shot.url }}" alt="shot">
           {% endthumbnail %}
          {% endfor %}
          <a href="{% url 'production' scene.production.slug %}">{{ scene.production.title }} ({{ scene.production.release.year }})</a><br>
         </div>
        {% endfor %}
       </div>
      </div>
     </div>
    {% endif %}
   {% endfor %}
  </div>

  <!-- Pagination -->
  {% paginator locations %}

 {% endif %}
{% endblock %}